<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>SyntaxHighlighter Vimscript brush and Blackboard theme</title>

    <link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>

  <body>
    <div id="logo">
      <h1>
        
          <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
        
      </h1>
    </div>
    <p>Here on Vimcasts.org, I use Alex Gorbatchev's <a href="http://alexgorbatchev.com/wiki/SyntaxHighlighter">SyntaxHighlighter</a> to colorize the code excerpts. I couldn't find a syntax 'brush' for Vimscript, so I wrote my own. I also created a color theme based on the Blackboard scheme that I use in Vim (and TextMate). </p>

<p></p>

<p>I have published the Vimscript brush and Blackboard theme on github. You can find them here:</p>

<ul>
  <li><a href="http://github.com/nelstrom/SyntaxHighlighter/blob/master/styles/shThemeBlackboard.css">Blackboard theme</a></li>
  <li><a href="http://github.com/nelstrom/SyntaxHighlighter/blob/master/scripts/shBrushVimscript.js">Vimscript syntax</a></li>
</ul>

<p>I created these two files, but everything else in the project is by Alex Gorbatchev and the SyntaxHighligher community. The project is not hosted on github, otherwise I would have forked it.</p>

<h3 id="vimscript-keywords">Vimscript keywords</h3>

<p>The Vimscript brush includes a large list of keywords. I copied this list from Vim's own syntax file, which you can open up in Vim by running <code>:edit $VIMRUNTIME/syntax/vim.vim</code>. When defining syntax files for Vim, you can use a form of shorthand, e.g. <code>e[dit]</code>, which is equivalent to including both <code>e</code> and <code>edit</code>. The SyntaxHighligher doesn't understand this convention, so I had to expand all of these abbreviations into longhand. I wrote a <a href="http://github.com/nelstrom/SyntaxHighlighter/blob/master/expander.rb">little ruby script</a> that does this for me. Here's the gist of it:</p>

<pre class="brush: ruby">
list = ['abc[lear]', 'argu[ment]', 'bel[owright]']
pattern = /(\w+)(\[(\w+)\])?/
output = []
list.each do |token|
  if token =~ pattern
    output &lt;&lt; $1 if $1.length &gt; 1
    if $3
      output &lt;&lt; $1 + $3
    end
  end
end
puts output.join(' ')
</pre>

<p>Since I first created the Vimscript brush, I have occasionally pruned the list of keywords. Although it might be handy that you can type <code>:e</code> instead of spelling out <code>:edit</code> in full, I don't really want the letter <code>e</code> to be considered a <em>keyword</em>. </p>

<p>This is a matter of taste, but I have come accross other situations where the shorthand actually caused problems. For example, if I want to include an angle bracket character (common in Vimscript when creating keymappings), I have to encode the <code>&lt;</code> character to it's HTML entity <code>&amp;lt;</code>. I found that the syntax highlighter would identify <code>lt</code> as a keyword (being shorthand for <code>ltag</code>), breaking the HTML entity up into something like <code>&amp;&lt;code class="keyword"&gt;lt&lt;/code&gt;;</code>. As a result, the angle bracket would instead appear spelled out as an HTML entity, with <code>lt</code> highlighted as a keyword!</p>

<p>This makes a good case for removing <code>lt</code> from the list of keywords. It is quite possible that there are other keywords in the list which could cause similar problems, as yet unencountered. If you try out the Vimscript brush and discover any of these problems, please let me know. Or better still, fork the project, fix it, and send me a pull request on Github.</p>


  </body>

</html>
