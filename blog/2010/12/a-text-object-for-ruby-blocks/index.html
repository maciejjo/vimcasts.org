<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>A text-object for ruby blocks</title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg.rss" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime.rss" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="blog blog_2010 blog_2010_12 blog_2010_12_a-text-object-for-ruby-blocks blog_2010_12_a-text-object-for-ruby-blocks_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      

<div class="row announcement-banner">
  <div class="small-12 column show-for-small-only">
    <div class="panel">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

      
    </div>
  </div>

  <div class="panel show-for-medium-up clearfix">
    <div class="small-8 column">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

    </div>

    <div class="small-4 column">
      
    </div>
  </div>

</div>



      <header>
        <h2>A text-object for ruby blocks</h2>
        <time pubdate="pubdate" datetime="2010-12-27">
          Dec 27, 2010
        </time>
        
          <div class="article-tags">
            Tagged with:
            <a href="/categories/text-objects">text-objects</a>, <a href="/categories/ruby">ruby</a>, <a href="/categories/plugins">plugins</a>
          </div>
        
      </header>

      <div data-swiftype-index="true">
        <p>Ever since learning about Vim&rsquo;s <a href="http://vimdoc.sourceforge.net/htmldoc/motion.html#text-objects">text-objects</a> I have wished that there was a way of selecting blocks in ruby code. Well, now there is. Today I am releasing a plugin that creates <a href="http://www.vim.org/scripts/script.php?script_id=3382">a custom text object for selecting ruby blocks</a>. Merry Christmas!</p>



<h3>Usage</h3>

<p>In ruby, a block is always closed with the <code>end</code> keyword. Ruby blocks may be opened using one of several keywords, including <code>module</code>, <code>class</code>, <code>def</code> <code>if</code> and <code>do</code>. The <a href="http://www.vim.org/scripts/script.php?script_id=3382">rubyblock</a> plugin is aware of each of these.</p>

<p>In the example image below, suppose your cursor was positioned on the word <code>def</code>. Typing <code>var</code> would enable visual mode, selecting <em>all</em> of the method definition. </p>

<p><img alt="The 'var' text-object selects all of the current ruby block" src="/images/blog/rubyblock-all.png" /></p>

<p>Whereas if you typed <code>vir</code>, everything <em>inside</em> of the method definition would be selected:</p>

<p><img alt="The 'vir' text-object selects inside of the current ruby block" src="/images/blog/rubyblock-inner.png" /></p>

<p>If you make a visual selection, you can expand it to encompass the outer ruby block by pressing <code>ar</code>, or you can contract your selection by pressing <code>ir</code>. You can repeat this as many times as you like. The image below begins with the innermost ruby block selected. By pressing <code>ar</code> again and again, the selection expands until it encompasses all of the outermost block. If you press <code>ir</code>, you can back up the other way, contracting the selection towards inner blocks.</p>

<p><img alt="You can expand or contract your selection by repeating 'ar' and 'ir' commands" src="/images/blog/rubyblock-scissorkick.png" /></p>

<h3>Installation</h3>

<p>If you like to <a href="http://vimcasts.org/e/27">keep your plugins under version control with pathogen</a>, then you will want to clone the <a href="https://github.com/kana/vim-textobj-user">textobj-user</a> and <a href="https://github.com/nelstrom/vim-textobj-rubyblock">textobj-rubyblock</a> plugins from github.</p>

<p>If you&rsquo;re old-school, you can get the <a href="http://www.vim.org/scripts/script.php?script_id=2100">textobj-user</a> and <a href="http://www.vim.org/scripts/script.php?script_id=3382">textobj-rubyblock</a> plugins from <a href="http://www.vim.org/scripts/index.php">vim.org</a>.</p>

<p>Note that the rubyblock plugin currently requires that the <a href="http://www.vim.org/scripts/script.php?script_id=39">matchit.vim</a> plugin is enabled. This can be done by adding the following line to your vimrc:</p>

<pre class="brush: vimscript">
runtime macros/matchit.vim
</pre>

<p>Also note, that there is a plugin called ruby-matchit, which calls itself &lsquo;matchit for ruby&rsquo;. If you have this installed, it may interfere with the operation of the rubyblock plugin. Also, matchit.vim supports ruby now (which was not the case when ruby-matchit was written), so there&rsquo;s no need to install them both.</p>

<p>Morgan Prior took the time to explain <a href="http://amaras-tech.co.uk/people/morgan/article/84">how to install the rubyblock plugin</a> on his blog, so go read that if my instructions are too brief. Thanks Morgan!</p>

<h3>Issues</h3>

<p>If you notice any unexpected behaviour, I would appreciate if you could report it on the <a href="https://github.com/nelstrom/vim-textobj-rubyblock/issues">github issue tracker</a> for this project.</p>

<h3>Thanks</h3>

<p>I never thought I had the vimscript chops to put this plugin together, but the <a href="http://www.vim.org/scripts/script.php?script_id=2100">textobj-user</a> framework made it possible. So I&rsquo;d like to say a big thankyou to <a href="http://whileimautomaton.net/">Kana</a> for his excellent work. </p>

      </div>

      <dl class="accordion" data-accordion>
        <dd>
        <a href="#comments">Comments</a>
        <div id="comments" class="content">
          <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'vimcasts'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </div>
        </dd>
      </dl>

      <div>
        <p>
        Like this article? Spread the word!
        TODO: add social sharing buttons here.
        </p>
      </div>

      <div>
  <hr/>
  <h3>Related content</h3>
  <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">

    
    

    
      <li>
        <h4><a href="/episodes/fugitive-vim---a-complement-to-command-line-git/">Fugitive.vim - a complement to command line git</a></h4>
        <p><a href="https://github.com/tpope/vim-fugitive">The fugitive plugin</a>, by Tim Pope, is a git wrapper for Vim. It  complements the command line interface to git, but doesn&rsquo;t aim to replace it. In this episode, we&rsquo;ll see how some of fugitive&rsquo;s commands can streamline your workflow.</p>

<p><em>This is the first of a five part series on fugitive.</em></p>


      </li>
    
      <li>
        <h4><a href="/publications">Publications</a></h4>
        <p>Make yourself a faster and more efficient developer with the help of <a href='/publications'>these publications</a>.</p>
      </li>
    
      <li>
        <h4><a href="/categories">Find by category</a></h4>
        <p>Vimcasts contains 65 free screencasts and 45 articles. <a href='/categories'>Browse all content by category</a>.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/synchronizing-plugins-with-git-submodules-and-pathogen/">Synchronizing plugins with git submodules and pathogen</a></h4>
        <p>If you use Vim on muliple machines, it can be difficult to keep your configuration files synchronized across them. One solution is to put your dotfiles under version control. In this episode, I demonstrate how to keep your vimrc and plugins synchronized using git submodules and the pathogen plugin.</p>


      </li>
    
      <li>
        <h4><a href="/training">Vim Training</a></h4>
        <p>Boost your productivity with a <a href='/training'>Vim training class</a>. Join a public class, or <a href='/training/private'>book a private session</a> for your team.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/aligning-text-with-tabular-vim/">Aligning text with Tabular.vim</a></h4>
        <p>There are times when you can improve the readability of your code by lining up the elements on neighbouring lines. In this episode, I demonstrate how this can be achieved using the <a href="https://github.com/godlygeek/tabular">Tabular</a> plugin.</p>


      </li>
    

  </ul>
</div>


      <div class="row footer">

  <hr/>

  <div class="small-6 columns">
    <ul class="inline-list">
      <li><a href="/about">About</a></li>
      <li><a href="/subscribe">Subscribe</a></li>
      <li><a href="/tipjar">Leave a tip</a></li>
    </ul>
  </div>

  <div class="small-6 columns">
    <p class="text-right">
    Vimcasts.org established MMX
    </p>
  </div>

</div>


    </div>
  </div>




      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>

