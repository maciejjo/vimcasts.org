<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title></title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="transcripts transcripts_30 transcripts_30_en transcripts_30_en_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

        <pre><code>1955, November 5th

1955, November 12th
    Lightning strikes the clocktower at 10.04pm
</code></pre>

<p>I'm going to start off by making a few changes to this file. Note that I leave insert mode after typing each line of text. Vim creates a record in the undo history each time I return to normal mode, so this gives me some control over the level of granularity that I'll see when I use the undo and redo commands.</p>

<pre><code>1955, November 5th
    George McFly falls out of a tree and is hit by a car.
    Lorraine Baines nurses George, and thinks he's cute.

1955, November 12th
    George McFly takes Lorraine Baines to the dance, and they kiss.
    Lightning strikes the clocktower at 10.04pm
</code></pre>

<p>You're no doubt used to the idea that you can use the undo command to go backwards in time, and then you can play it forwards again by using the redo command. But typically you can only move backwards and forwards along a single line of history. If I roll back a couple of edits then make a change to the document, I create a new branch in the timeline of the document's history. Let me just add one more change, to complete the storyâ€¦</p>

<pre><code>1955, November 5th
    Marty McFly is hit by a car.
    Lorraine Baines nurses Marty, and thinks he's cute.

1955, November 12th
    Marty Mcfly takes Lorraine Baines to the dance, and they kiss.
    Marty McFly invents Rock and Roll
    George McFly and Loraine Baines kiss.
    Lightning strikes the clocktower at 10.04pm
</code></pre>

<p>Now, when I invoke the undo command, I can get back to the state where the history of the document forked, but the redo command is fixed on the track that I just created. I can go back and forwards on the new timeline as often as I like, but the original timeline cannot be retrieved.</p>

<p>That is the world view of your average software. But Vim has a flux capacitor built in, which allows you to revisit undo states in the document's history that are beyond the reach of the redo command.</p>

<p>Lets replay each of the edits I made earlier, and this time we'll keep track of them using a graphical representation of the timeline. Each node in this graph represents the state of the document after a single editing operation. Having made a couple of edits, I'll invoke the undo command. This doesn't create a new node in the graph, it just reverts the document to a previous state.</p>

<p>Lets see what happens when I edit an earlier version of the document. This creates a fork in the timeline, and now when I use the undo and redo commands, they move me backwards and forwards along this new branch of history. It looks as though the old changes are no longer accessible.</p>

<p>But see how I've numbered each of the nodes in the graph, in the order that they were created? Well, you can consider this to be a chronological list of changes. If we redraw the graph so that the nodes are listed in chronological order, then suddenly we are back to having a linear structure. Vim provides commands that enable you to traverse this list forwards and backwards. Using these commands, it is possible to return to the states that were unreachable using the standard undo and redo commands.</p>

<p>The list of chronological changes can be difficult to follow, because two states may be positioned beside each other even though they are several steps apart in the graph. If we redraw the graph so that the fork is visible, but maintain the position of the nodes so that they are in chronological order, we get a more comprehensible overview of the undo tree. You can see where the document history diverged, but you can also see each state of the document in chronological order.</p>

<p>The <code>undo</code> and <code>redo</code> commands can move forwards and backwards along the <em>mainline</em> branch, but they are not able to switch between branches. When you step along a single track with undo and redo, each update corresponds to a coherent edit, so you can follow the evolution of your document.</p>

<p>The <code>g+</code> and <code>g-</code> commands traverse the list of historical states of the document. This means that they are capable of switching from one undo branch to another. Beware that jumping between branches can be disorienting, just like time travel. Nevertheless, this powerful feature means that you are never barred from revisiting an earlier state of your document.</p>

<p>Note that the document timeline records a time-stamp for each historical state, which makes it possible to revert the document to how it looked a particular number of seconds, minutes, hours or days before the current state. I can assure you, running <code>:earlier 20s</code> has saved my bacon on more than one occasion!</p>

<h1 id="introducting-gundovim">Introducting Gundo.vim</h1>

<p>Vim's notion of history is powerful, but it is difficult to get your head around. Wouldn't it be nice if you could view an interactive visualisation of the history tree? Well, now you can, using Steve Losh's G-undo plugin.</p>

<p>Installation is straightforward, you'll find a link to instructions in the shownotes for this episode. The plugin does not provide a keymapping to toggle the history viewer, so you'll probably want to create one in your vimrc file.</p>

<p>I've set up <code>&lt;f5&gt;</code> so that it toggles the history window. In the top pane, we get an ascii representation of the history graph, and the bottom window shows you a diff between the selected node and its historical predecessor. I can use the <code>j</code> and <code>k</code> keys to traverse up and down the nodes of the tree, and pressing enter sets the document to the specified state. This makes it much easier to work with Vim's history tree. I highly recommend installing it and playing around with it.</p>

<p>The plugin requires Vim 7.3 or later, so if you haven't updated yet, this is a good reason to get the latest version. Also, the plugin requires Vim built with support for python scripting. </p>


      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>
