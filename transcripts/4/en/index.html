<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title></title>

    <link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>

  <body>
    <div id="logo">
      <h1>
        
          <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
        
      </h1>
    </div>

    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/episodes">Episodes</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/training">Training</a></li>
        <li><a href="/paths">Pathways</a></li>
        <li><a href="/publications">Publications</a></li>
      </ul>
    </nav>

    <h2 id="convert-between-tabs-with-spaces">Convert between tabs with spaces</h2>

<p>It is sometimes useful to be able to convert between tabs and spaces
for indentation. If you collborate on a project without agreeing on a
convention for indentation, there's a good chance that at some point
you'll see something like this.</p>

<p>It looks as though this file hasn't been indented correctly. If I reveal
the invisible characters, you can see that one block of text has been
indented using spaces, whereas the rest of the file uses tab
characters.</p>

<p>Now if I change the value of <code>tabstop</code> from 4 to 2, everything appears
to snap into place.</p>

<p>To avoid this kind of confusion, lets fix the indentation style to use
tab characters throughout the file.</p>

<p>First, make sure that <code>expandtab</code> is switched off, by running <code>:set
noexpandtab</code>. Then run the command:</p>

<pre><code>:retab!
</code></pre>

<p>This inserts tab characters to replace spaces of an equivalent width
throughout the entire file.</p>

<p>Now if I enable <code>expandtab</code> and run the command again, it converts all
the tabs to back to spaces.</p>

<p>If I don't want to affect the entire file, I can make a visual
selection first, then run <code>:retab!</code>, and it will only affect the
selected lines.</p>

<h2 id="strip-trailing-characters">Strip trailing characters</h2>

<p>Trailing spaces at the end of a line are another of those issues that
divide programmers. While it drives some of us crazy, others just
don't care or even notice, perhaps.</p>

<p>In Vim, you can easily strip trailing whitespace from a file using a
substitute command:</p>

<pre><code>:%s/\s\+$//e
</code></pre>

<p>This breaks down as follows:</p>

<ul>
  <li>The colon enters command mode</li>
  <li>The <code>s</code> is short for the substitute command</li>
  <li>The percent sign specifies that the entire file should be affected
(not just the current line).</li>
  <li>the first two forward slashes delimit the search pattern</li>
  <li><code>\s</code> stands for a whitespace character, and the escaped plus sign
(+) indicates that one or more spaces should be matched, preceding a
line end (the dollar sign)</li>
  <li>the last two slashes delimit the replacement string. Here, it is blank,
so it replaces trailing whitespace with nothing.</li>
  <li>The <code>e</code> flag suppresses an error message if no matches are found.</li>
</ul>

<p>This is a lot to type, so you might want to try mapping it to a
shortcut. You could put the following in your .vimrc, which maps this
to the <code>F5</code> key:</p>

<pre><code>:nnoremap &lt;F5&gt; :%s/\s\+$//e&lt;CR&gt;
</code></pre>

<p>But there are a couple of side-effects to running this command.  One
is that your cursor will be moved from its current position to the
last line where the substitution was made. Another is that the last
item in your search history is set to the pattern of whitespace at the
end of a line. If you have search highlighting enabled, then you will
see spaces highlighted momentarily as you type, which can be a little
distracting. Here is a function that gets around these problems.</p>

<pre><code>function! &lt;SID&gt;StripTrailingWhitespaces()
    " Preparation: save last search, and cursor position.
    let _s=@/
    let l = line(".")
    let c = col(".")
    " Do the business:
    %s/\s\+$//e
    " Clean up: restore previous search history, and cursor position
    let @/=_s
    call cursor(l, c)
endfunction
</code></pre>

<p>If you include this in your .vimrc file, you can then map it to a
key like this:</p>

<pre><code>nnoremap &lt;silent&gt; &lt;F5&gt; :call &lt;SID&gt;StripTrailingWhitespaces()&lt;CR&gt;
</code></pre>

<p>It is also possible to use an autocommand to call this function just
before saving a file. Be aware that in some filetypes, spaces at the
end of a line can have meaning, so stripping them could potentially
break the file. For example, in this snippet of vimscript, the
space at the end of the line is intentional:</p>

<pre><code>set listchars=eol:¬,tab:▸\ 
</code></pre>

<p>If you choose to enable this autocommand, I would recommend providing
a whitelist of filetypes which you are sure won't be broken by
stripping trailing spaces. This example causes the autocommand to be
fired before saving python and javascript files only.</p>

<pre><code>autocmd BufWritePre *.py,*.js :call &lt;SID&gt;StripTrailingWhitespaces()
</code></pre>

<p>Use this as a template, and add other filetypes to suit your needs.</p>

<h2 id="strip-blank-lines">Strip blank lines</h2>

<p>Sometimes you'll open a file, and find that it has too many extraneous
blank lines, making it difficult to read. You can quickly strip out
all empty lines with this command:</p>

<pre><code>:g/^$/d
</code></pre>

<p>This breaks down as follows:</p>

<ul>
  <li><code>:g</code> creates a global command, that is, one that will opperate on the
entire file.</li>
  <li>the forward slashes delimit a pattern to search for
in this case, the caret-dollar pattern matches a line beginning
followed immediatly by a line-end. That is: a blank line.</li>
  <li>the part following the pattern is an Ex command to be executed on all
matching lines. </li>
  <li>in this case, the <code>d</code> command deletes the line</li>
</ul>

  </body>

</html>
