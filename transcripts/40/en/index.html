<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title></title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="transcripts transcripts_40 transcripts_40_en transcripts_40_en_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      
        <h1><a href="/episodes/long-range-line-duplication/">Long-range line duplication</a></h1>
        <h2>Transcript for episode #40</h2>

        <p>When writing code, we can often save time by duplicating a line then changing one or two parts of that line to make it suit our purposes. In this episode, we&rsquo;ll compare a few techniques for duplicating lines, and we&rsquo;ll see that the <code>:copy</code> Ex command is well suited to this task.</p>


      

      <p>[prep: :set nonumber foldcolumn=1]</p>

<p>Here&rsquo;s the brief: we&rsquo;ll copy this line (#9), and place a duplicate of it here. It&rsquo;s a simple task, but we&rsquo;ll see that there are severeal different ways of getting the job done.</p>

<h2>Linewise move, yank, linewise move, put</h2>

<p>Let&rsquo;s start with a na√Øve attempt. We&rsquo;ll move our cursor linewise to the bit we want to copy, then yank that line:</p>
<pre class="highlight plaintext">kkkkkkk
yy
</pre>

<p>Then we&rsquo;ll reverse back to where we started, and paste the line that we yanked:</p>
<pre class="highlight plaintext">jjjjjjj
p
</pre>

<p>If you care about using Vim well, this should make you wince.</p>

<p>Let&rsquo;s look at those keystrokes. It should be immediately striking that most of these keystrokes are simply moving the cursor, one line at a time. We can do better than this.</p>

<h2>Line jump, yank, snapback, put</h2>

<p>Let&rsquo;s undo that change, and start again. I&rsquo;m going to turn on line numbers, by running:</p>
<pre class="highlight plaintext">:set number
</pre>

<p>Now we can see the number of the line that we want to copy: it&rsquo;s line 9. We can get there in a single move: by pressing 9G (nine-shift-gee), to <em>go to the specified line</em>. As before, we&rsquo;ll yank the current line:</p>
<pre class="highlight plaintext">9G
yy
</pre>

<p>Now we could get back to where we came from by pressing 16G (sixteen-shift-gee), but there&rsquo;s a better way. You see, the goto line motion creates a record in Vim&rsquo;s jumplist. That means that we can snap back to where we came from using the <code>ctrl-o</code> command. </p>
<pre class="highlight plaintext">&lt;C-o&gt;
p
</pre>

<p>Now that our cursor is in the correct position, we can paste the line that we yanked. Job done!</p>

<p>Comparing the last two solutions, we can see that jumping to a linenumber can save a lot of keystrokes compared to moving the cursor one line at a time. Also, using the jumplist to snapback to where we came from means that we only have to look up one line number, instead of two. That&rsquo;s not a great saving in terms of keystrokes, but it is a saving in terms of brain-cycles.</p>

<h2>Remote yank, put</h2>

<p>Vim has another command for jumping to a specified line number. Instead of pressing nine-shift-gee, we could press colon-nine-enter:</p>
<pre class="highlight plaintext">:9
</pre>

<p>This is an Ex command, so the specified number is treated as an address. The result in this case is that the cursor is moved to the specified line number.</p>

<p>But watch this. I&rsquo;ll just move my cursor back to where it started, then I&rsquo;ll run (colon-nine-yank):</p>
<pre class="highlight plaintext">:9yank
</pre>

<p>This yanks the specified line, and the cool thing about this command is that it doesn&rsquo;t move the cursor. We&rsquo;ve got it right where we want it, so now we can paste the line using the Normal mode <code>p</code> command.</p>

<p>Altogether, that sequence of commands can be reduced to:</p>
<pre class="highlight plaintext">:9y
p
</pre>

<p>Our cursor never moves, so this technique allows us to cut the number of steps in half.</p>

<p>Pretty neat! But we can still do better.</p>

<h2>Copy</h2>

<p>Vim has another Ex command which combines the yank and put steps into one. It&rsquo;s called :copy:</p>
<pre class="highlight plaintext">:help :copy
</pre>

<p>It accepts a range, and an address. The range is the line (or lines) that you want to copy. The address is the destination where you want the duplicated line to appear.</p>

<p>In our example, we want to copy line 9, and paste the duplicate below line 16. That translates to:</p>
<pre class="highlight plaintext">:9copy16
</pre>

<p>Bang! Job done, in one move.</p>

<p>But this is the long-hand form. We can shave off a few more keystrokes. First of all, the copy command has a one-letter alias (colon-tee):</p>
<pre class="highlight plaintext">:help :t
</pre>

<p>As a mnemonic, I think of it as <em>copy TO</em>. Using that, we can cut this down to:</p>
<pre class="highlight plaintext">:9t16
</pre>

<p>There&rsquo;s some redundant information in this command: can you spot it?</p>

<p>[pause]</p>

<p>Our cursor is positioned on line 16, so why should we have to look up that address and type the number into our command line? In Ex commands, where an address is expected, you can always use the dot symbol as a shorthand for the current line. So we can reduce this to:</p>
<pre class="highlight plaintext">:9t.
</pre>

<p>That reads as: take line 9, copy to, below the current line. That&rsquo;s a lot of information packed into three characters! And it&rsquo;s about as far as we can compress this. </p>

<h2>:set relativenumber</h2>

<p>You might be thinking: &lsquo;how can I use this with relativenumber?&rsquo; Well, let&rsquo;s see. I&rsquo;ll enable the relativenumber setting:</p>
<pre class="highlight plaintext">:set relativenumber
</pre>

<p>With this enabled, Vim shows line numbers relative to the cursor position. </p>

<p>The line that we want to duplicate is now labelled seven, which means it&rsquo;s seven lines above the current cursor position.</p>

<p>If we prefix our address with a minus or plus sign, then Vim will calculate the line number as an offset against the current line. So we can simply say:</p>
<pre class="highlight plaintext">:-7t.
</pre>

<p>And that does the job. So you can use the <code>:t</code> command whether you use absolute or relative line numbering.</p>

    </div>
  </div>


      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>
