<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title></title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg.rss" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime.rss" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="transcripts transcripts_27 transcripts_27_en transcripts_27_en_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      
        <h1><a href="/episodes/synchronizing-plugins-with-git-submodules-and-pathogen/">Synchronizing plugins with git submodules and pathogen</a></h1>
        <h2>Transcript for episode #27</h2>

        <p>If you use Vim on muliple machines, it can be difficult to keep your configuration files synchronized across them. One solution is to put your dotfiles under version control. In this episode, I demonstrate how to keep your vimrc and plugins synchronized using git submodules and the pathogen plugin.</p>


      

      <h2>Create a dotvim repository</h2>

<p>Typically, your vim configuration is held in a hidden file named &ldquo;dot-vimrc&rdquo; in your home directory. If you want to make any customisations for graphical Vim, you can keep those in a file named &ldquo;dot-gvimrc&rdquo;. Additionally, you can keep plugins, colorschemes and other scripts in a hidden directory named &ldquo;dot-vim&rdquo;.</p>

<p>To keep all of these items under version control, I&rsquo;m going to begin by moving my vimrc and gvimrc files into the dotvim directory. I have chosen to rename them without a leading dot, which means that they won&rsquo;t be hidden inside the dotvim directory.</p>
<pre class="highlight plaintext">mv ~/.vimrc ~/.vim/vimrc
mv ~/.gvimrc ~/.vim/gvimrc
</pre>

<p>When Vim starts up, it is still going to look for a file called <code>.vimrc</code> in the home directory. I want it to read the vimrc file inside my dotvim directory, so I&rsquo;ll create a symbolic link to that file. I&rsquo;ll do the same thing for the gvimrc file too.</p>
<pre class="highlight plaintext">ln -s ~/.vim/vimrc ~/.vimrc
ln -s ~/.vim/gvimrc ~/.gvimrc
</pre>

<p>Finally, I want to turn the dotvim directory into a git repository. I&rsquo;m going to create a README file, which will include simple instructions on how to install these Vim configuration files on any machine that has git installed.</p>
<pre class="highlight plaintext">cd ~/.vim
git init
vim README
" Paste instructions for symlinking .vimrc/.gvimrc
</pre>

<p>I&rsquo;ll commit these changes, and now my repository is ready to publish.</p>
<pre class="highlight plaintext">git add .
git commit -m 'Initial commit'
</pre>

<h2>Publish to github</h2>

<p>I recommend publishing your configuration files to github. It&rsquo;s really easy to set up an account, and they will host your open source projects for free.</p>

<p>Here, I&rsquo;ve signed in to github, and on the homepage I click the &ldquo;New repository&rdquo; button. I&rsquo;m going to call this repository &ldquo;dotvim&rdquo;. When I click the &ldquo;Create repository&rdquo; button, github provides precise instructions on how to get started. The instructions are tailored to my situation, so I can copy and paste them directly into the Terminal. After pushing the repository, I can click the &ldquo;continue&rdquo; link to view the new homepage for this project. Note that the README file is listed on the homepage.</p>

<h2>Synchronise your changes to another machine</h2>

<p>Having published my dotvim repository to github, I&rsquo;m now going to show how easy it is to synchronise my configuration to another machine. Here, I&rsquo;ve got a fresh install of Ubuntu running as a virtual machine. I&rsquo;ve already installed the git and vim packages.</p>

<p>The README file that I created earlier includes all of the instructions that I need, so I&rsquo;ll just follow these. I begin by cloning the git repository to my home directory:</p>
<pre class="highlight plaintext">git clone http://github.com/nelstrom/dotvim.git ~/.vim
</pre>

<p>Then I create symbolic links for <code>.vimrc</code> and <code>.gvimrc</code> files:</p>
<pre class="highlight plaintext">ln -s ~/.vim/vimrc ~/.vimrc
</pre>

<p>Now, when I launch Vim, it should load all of the configuration settings that I have saved in my dotvim files.</p>

<h2>Make a change to the vimrc file</h2>

<p>Back in my local machine, I&rsquo;m now going to create a new command in my vimrc. It simply prints some text at the bottom of the screen:</p>
<pre class="highlight plaintext">command! Status echo "All systems are go!"
</pre>

<p>Having saved this change, I then commit it to my git repository, and push to github.</p>
<pre class="highlight plaintext"># On mac:
git commit -cm "Add a Status command"
git push
</pre>

<p>Back on the linux machine, I can now fetch the latest version from github:</p>
<pre class="highlight plaintext">git pull
</pre>

<p>When I launch Vim again, I should have access to the new <code>:Status</code> command.</p>

<h1>Version control your plugins</h1>

<p>The traditional method for installing Vim plugins is to copy each script that is distributed with the plugin into the corresponding <code>.vim</code> subdirectory. For example, if you wanted to install Fugitive.vim (a git wrapper for Vim), you would copy the documentation file into <code>.vim/doc</code>, and copy the plugin file into <code>.vim/plugin</code>. You could then check these in to your git repository, and they could be syncronised across machines as easily as the rest of your configuration files. But you lose something by doing this. The Fugitive plugin itself is kept under version control with git. It would be much better if you could keep it that way.</p>

<h2>Install pathogen.vim</h2>

<p>The pathogen plugin makes it possible to cleanly install plugins as a bundle. Rather than having to place all of your plugins side by side in the same directory, you can keep all of the files for each individual plugin together in one directory. This makes installation more straightforward, and also simplifies the tasks of upgrading and even removing a plugin if you decide you no longer need it.</p>

<p>To install Pathogen, download the script and place it in your <code>.vim/autoload</code> directory (if the directory doesn&rsquo;t exist, you&rsquo;ll have to create it).</p>

<p>There are a couple of lines that you should add to your .vimrc file to activate pathogen.</p>
<pre class="highlight plaintext">call pathogen#runtime_append_all_bundles()
call pathogen#helptags()
</pre>

<p>It is essential that these lines are called before enabling filetype detection, so I would recommend putting them at the top of your vimrc file. </p>

<h2>Install plugins as git submodules</h2>

<p>With pathogen installed, it&rsquo;s now possible to keep the files for each plugin together, which means that every plugin can be kept in its own git repository. The best way to do this is to use git submodules, which are designed especially for the purpose of keeping git repositories within a git repository.</p>

<p>I&rsquo;ll demonstrate how to install the Fugitive plugin as a submodule, then I&rsquo;ll show how to synchronise those changes on to my Ubuntu setup.</p>

<p>First, I&rsquo;ll navigate to the root of my dotvim git repository.</p>
<pre class="highlight plaintext">cd ~/.vim
</pre>

<p>From github, I&rsquo;ll copy the URL for the fugitive plugin. This is exactly the same URL that you would use if you were going to clone the repository. But instead, I&rsquo;m going to add it as a submodule. The command goes:</p>
<pre class="highlight plaintext">git submodule add http://github.com/tpope/vim-fugitive.git bundle/fugitive

git submodule add URL_for_repository local_path_to_bundle
</pre>

<p>This command clones the git repository to the specified path, whilst instructing the dotvim repository to treat the plugin as a submodule. A new hidden file called <code>.gitmodules</code> is created in the root of the current repository. This file contains information about this and any other submodules.</p>

<p>Note that the repository is called &ldquo;vim-fugitive&rdquo;, which is sensible because it makes it more visible to anybody searching github for Vim plugins. But I&rsquo;ve decided to remove the &ldquo;vim-&rdquo; prefix when copying it locally, because the context makes it clear that it is a vim bundle.</p>

<p>Having installed the Fugitive plugin, I now want to commit the change, and push to github.</p>

<h2>Synchronise plugins to another machine</h2>

<p>Now I&rsquo;ll show you how to synchronise my submodules to another machine. Switching back to Ubuntu, I&rsquo;ll change to the dotvim repository, and pull the latest changeset. </p>
<pre class="highlight plaintext">cd ~/.vim
git pull
</pre>

<p>If I run <code>git log</code>, you should see that it matches the most recent commit that I pushed from my other machine. </p>

<p>At the moment, the <code>bundle/fugitive</code> directory exists, but it contains no files. </p>

<p>Running:</p>
<pre class="highlight plaintext">git submodule init
</pre>

<p>registers the submodule, then running:</p>
<pre class="highlight plaintext">git submodule update
</pre>

<p>Checks out the version of the Fugitive repository that was committed to the dotvim repository.</p>

<p>It might look like a lot of work for just synchronising a single plugin. But if I had installed 20 Vim bundles as git submodules, I would still only have to run the same two commands: <code>git submodule init</code>, then <code>update</code>, and all of the bundles would be copied over.</p>

<h1>Summary</h1>

<p>Once your vim configuration is under version control, it&rsquo;s quite straightforward to import your settings to any machine that has git installed. To recap, here are the commands that I ran on the Ubuntu virtual machine:</p>
<pre class="highlight plaintext">cd ~
git clone http://github.com/username/dotvim.git ~/.vim
ln -s ~/.vim/vimrc ~/.vimrc
ln -s ~/.vim/gvimrc ~/.gvimrc
cd ~/.vim
git submodule init
git submodule update
</pre>

<ul>
<li>From the home directory</li>
<li>clone my dotvim repository into a ~/.vim directory</li>
<li>create symlinks for vimrc and gvimrc files</li>
<li>then from the dotvim directory</li>
<li>initialize submodules</li>
<li>and update them</li>
</ul>

<h1>Outro</h1>

<p>You can adapt the method demonstrated here to suit your needs. Personally, I use a slightly different approach, which keeps all of my dotfiles (including bashrc, irbrc and so on) under version control in one place. If you have another way of doing it I&rsquo;d like to hear about it, so leave a comment in the shownotes.</p>

    </div>
  </div>


      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>
