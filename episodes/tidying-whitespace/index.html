
<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Tidying whitespace</title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg.rss" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime.rss" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="episodes episodes_tidying-whitespace episodes_tidying-whitespace_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      

<div class="row announcement-banner">
  <div class="small-12 column show-for-small-only">
    <div class="panel">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

      
    </div>
  </div>

  <div class="panel show-for-medium-up clearfix">
    <div class="small-8 column">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

    </div>

    <div class="small-4 column">
      
    </div>
  </div>

</div>



      <header>
        <h2>Tidying whitespace</h2>
        <div class="episode_number">
          <small>#</small>4
        </div>
        <time pubdate="pubdate" datetime="2010-01-24">
          Jan 24, 2010
        </time>
        <div class="video-duration">
          
          Run time: <time datetime="P4M,33S">
            4:33
          </time>
        </div>
        
          <div class="video-tags">
            Tagged with:
            <a href="/categories/whitespace">whitespace</a>, <a href="/categories/editing-text">editing-text</a>, <a href="/categories/customizations">customizations</a>
          </div>
        
      </header>

      <div data-swiftype-index="true">
        <p>This episode demonstrates a few techniques for tidying up whitespace.  First, it looks at how to convert between tabs and spaces. Then it shows how to strip trailing whitespace, and finally, how to remove blank lines from a file.</p>


      </div>

      <video poster="http://vimcasts.org/images/posters/tidying_whitespace.png"
        controls="controls" preload="none" class="placeholder"
        id="episode_4_placeholder">
        <source src="http://media.vimcasts.org/videos/4/tidying_whitespace.ogv" type="video/ogg" />
        <source src="http://media.vimcasts.org/videos/4/tidying_whitespace.m4v" type="video/x-m4v" />
      </video>

      <aside class="downloads">
        <ul class="inline-list">
          <li>Download: </li>

          <li class="ogg">
          <a href="http://media.vimcasts.org/videos/4/tidying_whitespace.ogv">OGG</a>
          <span class="stats">4.7 MB</span>
          </li>

          <li class="quicktime">
          <a href="http://media.vimcasts.org/videos/4/tidying_whitespace.m4v">Quicktime</a>
          <span class="stats">5.5 MB</span>
          </li>

      </ul>

        <p>
          View a <a href="/transcripts/4/en/">transcript of the video</a>.
        </p>
      </aside>

      <dl class="accordion" data-accordion>
        <dd>
        <a href="#shownotes">Shownotes</a>
        <div id="shownotes" class="content" data-swiftype-index="true">
          

<h3>Converting between tabs and spaces</h3>

<p>The command for converting between tabs and spaces is:</p>
<pre class="highlight viml"><span class="p">:</span><span class="k">retab</span><span class="p">!</span>
</pre>

<p>More specifically, to convert tabs to spaces, run:</p>
<pre class="highlight viml"><span class="p">:</span><span class="k">set</span> expandtab
<span class="p">:</span><span class="k">retab</span><span class="p">!</span>
</pre>

<p>And to convert spaces to tabs, run:</p>
<pre class="highlight viml"><span class="p">:</span><span class="k">set</span> noexpandtab
<span class="p">:</span><span class="k">retab</span><span class="p">!</span>
</pre>

<h3>Strip trailing whitespace</h3>

<p>Strip trailing spaces throughout an entire file by running this
substitution command:</p>
<pre class="highlight viml"><span class="p">:</span>%<span class="k">s</span><span class="sr">/\s\+$/</span>/<span class="k">e</span>
</pre>

<p>This has a couple of side-effects: it moves your cursor, and sets the
last item in your search history to trailing whitespace. This function
gets around these problems:</p>
<pre class="highlight viml"><span class="k">function</span><span class="p">!</span> <span class="p">&lt;</span>SID<span class="p">&gt;</span>StripTrailingWhitespaces<span class="p">()</span>
    <span class="c">" Preparation: save last search, and cursor position.</span>
    <span class="k">let</span> _s<span class="p">=</span>@/
    <span class="k">let</span> <span class="k">l</span> <span class="p">=</span> line<span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
    <span class="k">let</span> <span class="k">c</span> <span class="p">=</span> <span class="k">col</span><span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
    <span class="c">" Do the business:</span>
    %<span class="k">s</span><span class="sr">/\s\+$/</span>/<span class="k">e</span>
    <span class="c">" Clean up: restore previous search history, and cursor position</span>
    <span class="k">let</span> @/<span class="p">=</span>_s
    <span class="k">call</span> cursor<span class="p">(</span><span class="k">l</span><span class="p">,</span> <span class="k">c</span><span class="p">)</span>
<span class="k">endfunction</span>
</pre>

<p>Put it in your .vimrc file.</p>

<p>If you want to map this function to a key (e.g. F5), add this:</p>
<pre class="highlight viml">nnoremap <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>F5<span class="p">&gt;</span> <span class="p">:</span><span class="k">call</span> <span class="p">&lt;</span>SID<span class="p">&gt;</span>StripTrailingWhitespaces<span class="p">()&lt;</span>CR<span class="p">&gt;</span>
</pre>

<p>If you want to run this command automatically when a file is saved,
add this:</p>
<pre class="highlight viml">autocmd <span class="nb">BufWritePre</span> *<span class="p">.</span><span class="k">py</span><span class="p">,</span>*<span class="p">.</span>js <span class="p">:</span><span class="k">call</span> <span class="p">&lt;</span>SID<span class="p">&gt;</span>StripTrailingWhitespaces<span class="p">()</span>
</pre>

<p>This example runs the autocommand on python and javascript files. Use
this as a template, and add other filetypes to suit your needs.</p>

<h3>Delete blank lines</h3>

<p>You can delete all blank lines by running the following command:</p>
<pre class="highlight viml"><span class="p">:</span><span class="k">g</span><span class="sr">/^$/</span><span class="k">d</span>
</pre>

<h3>Further reading</h3>

<ul>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/repeat.html#:global"><code>:help :g[lobal]</code></a></li>
<li><a href="http://vim.wikia.com/wiki/Remove_unwanted_spaces">Remove unwanted spaces</a> (on the Vim tips wiki)</li>
<li><a href="http://stackoverflow.com/questions/356126/how-can-you-automatically-remove-trailing-whitespace-in-vim">Automatically remove trailing spaces</a> (on Stackoverflow.com)</li>
</ul>

<h3>Updates</h3>

<p>In the comments, <a href="http://vimcasts.org/episodes/tidying-whitespace/?success#comment-37459247">k00pa</a> has posted a method based on
<code>StripTrailingWhitespaces()</code>, which applies Vim&rsquo;s autoformat command to the
entire file then restores the cursor position. <a href="http://technotales.wordpress.com/2010/03/31/preserve-a-vim-function-that-keeps-your-state/">Jonathan Palardy</a>
has recognised that <code>StripTrailingWhitespaces()</code></p>

<blockquote>
<p>doesn’t do one thing, it does two (useful) things: saving the “state” and
executing a command to remove the trailing whitespace.</p>
</blockquote>

<p>He suggests refactoring the methods as follows:</p>
<pre class="highlight viml"><span class="k">function</span><span class="p">!</span> Preserve<span class="p">(</span>command<span class="p">)</span>
  <span class="c">" Preparation: save last search, and cursor position.</span>
  <span class="k">let</span> _s<span class="p">=</span>@/
  <span class="k">let</span> <span class="k">l</span> <span class="p">=</span> line<span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
  <span class="k">let</span> <span class="k">c</span> <span class="p">=</span> <span class="k">col</span><span class="p">(</span><span class="s2">"."</span><span class="p">)</span>
  <span class="c">" Do the business:</span>
  execute <span class="nv">a:command</span>
  <span class="c">" Clean up: restore previous search history, and cursor position</span>
  <span class="k">let</span> @/<span class="p">=</span>_s
  <span class="k">call</span> cursor<span class="p">(</span><span class="k">l</span><span class="p">,</span> <span class="k">c</span><span class="p">)</span>
<span class="k">endfunction</span> 
nmap _$ <span class="p">:</span><span class="k">call</span> Preserve<span class="p">(</span><span class="s2">"%s/\\s\\+$//e"</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
nmap _<span class="p">=</span> <span class="p">:</span><span class="k">call</span> Preserve<span class="p">(</span><span class="s2">"normal gg=G"</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</pre>

<p>I do like his choice of key mapping as well. The underscore key is not often
used, so makes for a good alternate <code>&lt;leader&gt;</code>. The <code>$</code> key is practically
synonymous with <em>end of line</em>, so it makes for a good mnemonic.</p>

<p>Jonathan goes into a little more detail on his blog. Go read: <a href="http://technotales.wordpress.com/2010/03/31/preserve-a-vim-function-that-keeps-your-state/">Preserve: A
Vim function that keeps your state</a>.</p>

        </div>
        </dd>
        <dd>
        <a href="#comments">Comments</a>
        <div id="comments" class="content">
          <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'vimcasts'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </div>
        </dd>
      </dl>

      <div>
        <p>
        Like this video? Spread the word!
        TODO: add social sharing buttons here.
        </p>
      </div>


      <div>
  <hr/>
  <h3>Related content</h3>
  <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">

    
    

    
      <li>
        <h4><a href="/episodes/whitespace-preferences-and-filetypes/">Whitespace preferences and filetypes</a></h4>
        <p>Different file types may require particular whitespace settings. For example, YAML files must be indented using spaces, whereas makefiles require indentation with tabs. These preferences can be specified by hooking into the <code>FileType</code> event with an autocommand.</p>


      </li>
    
      <li>
        <h4><a href="/categories">Find by category</a></h4>
        <p>Vimcasts contains 65 free screencasts and 45 articles. <a href='/categories'>Browse all content by category</a>.</p>
      </li>
    
      <li>
        <h4><a href="/publications">Publications</a></h4>
        <p>Make yourself a faster and more efficient developer with the help of <a href='/publications'>these publications</a>.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/bubbling-text/">Bubbling text</a></h4>
        <p>TextMate has a few built in commands for moving selected text around a document. The end end result of using these commands can be achieved by cutting and pasting, but the visual feedback they provide is quite helpful. In this episode, I will show how to replicate these commands in Vim.</p>


      </li>
    
      <li>
        <h4><a href="/training">Vim Training</a></h4>
        <p>Boost your productivity with a <a href='/training'>Vim training class</a>. Join a public class, or <a href='/training/private'>book a private session</a> for your team.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/indentation-commands/">Indentation commands</a></h4>
        <p>This episode covers the commands for shifting text left and right (<code>&lt;</code> and <code>&gt;</code>), and also goes over the auto indent command (<code>=</code>).</p>


      </li>
    

  </ul>
</div>


      <div class="row footer">

  <hr/>

  <div class="small-6 columns">
    <ul class="inline-list">
      <li><a href="/about">About</a></li>
      <li><a href="/subscribe">Subscribe</a></li>
      <li><a href="/tipjar">Leave a tip</a></li>
    </ul>
  </div>

  <div class="small-6 columns">
    <p class="text-right">
    Vimcasts.org established MMX
    </p>
  </div>

</div>


    </div>
  </div>




      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>

