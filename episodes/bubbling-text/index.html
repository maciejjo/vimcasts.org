
<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Bubbling text</title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="episodes episodes_bubbling-text episodes_bubbling-text_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      

<div class="row announcement-banner">
  <div class="small-12 column show-for-small-only">
    <div class="panel">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

      
    </div>
  </div>

  <div class="panel show-for-medium-up clearfix">
    <div class="small-8 column">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

    </div>

    <div class="small-4 column">
      
    </div>
  </div>

</div>



      <header>
        <h2>Bubbling text</h2>
        <div class="episode_number">
          <small>#</small>26
        </div>
        <time pubdate="pubdate" datetime="2010-10- 5">
          Oct  5, 2010
        </time>
        <div class="video-duration">
          
          Run time: <time datetime="P6M,23S">
            6:23
          </time>
        </div>
        
          <div class="video-tags">
            Tagged with:
            <a href="/categories/customization">customization</a>, <a href="/categories/editing-text">editing-text</a>
          </div>
        
      </header>

      <div data-swiftype-index="true">
        <p>TextMate has a few built in commands for moving selected text around a document. The end end result of using these commands can be achieved by cutting and pasting, but the visual feedback they provide is quite helpful. In this episode, I will show how to replicate these commands in Vim.</p>


      </div>

      <video poster="http://vimcasts.org/images/posters/bubbling_text.png"
        controls="controls" preload="none" class="placeholder"
        id="episode_26_placeholder">
        <source src="http://media.vimcasts.org/videos/26/bubble_selection.ogv" type="video/ogg" />
        <source src="http://media.vimcasts.org/videos/26/bubble_selection.m4v" type="video/x-m4v" />
      </video>

      <aside class="downloads">
        <ul class="inline-list">
          <li>Download: </li>

          <li class="ogg">
          <a href="http://media.vimcasts.org/videos/26/bubble_selection.ogv">OGG</a>
          <span class="stats">8.5 MB</span>
          </li>

          <li class="quicktime">
          <a href="http://media.vimcasts.org/videos/26/bubble_selection.m4v">Quicktime</a>
          <span class="stats">16.8 MB</span>
          </li>

      </ul>

        <p>
          View a <a href="/transcripts/26/en/">transcript of the video</a>.
        </p>
      </aside>

      <dl class="accordion" data-accordion>
        <dd>
        <a href="#shownotes">Shownotes</a>
        <div id="shownotes" class="content" data-swiftype-index="true">
          

<p>In TextMate, the commands for moving selected text can be found under the "Text &gt; Move Selection" menu. I find "move selected line up" to be an acurate but dull description. Personally, I prefer to call this feature <em>text bubbling</em>. </p>

<p><img alt="TextMate's Move selection commands" src="/images/blog/bubble-text.png" /></p>

<p>In the video, I describe two different ways of reproducing the text bubbling feature.</p>

<h2 id="text-bubble-with-vim-primitives">Text bubble with Vim primitives</h2>

<p>By putting the following in your <code>.vimrc</code> file, you can create maps for bubbling text up and down:</p>

<pre class="brush: vimscript">
&quot; Bubble single lines
nmap &lt;C-Up&gt; ddkP
nmap &lt;C-Down&gt; ddp
&quot; Bubble multiple lines
vmap &lt;C-Up&gt; xkP`[V`]
vmap &lt;C-Down&gt; xp`[V`]
</pre>

<h3 id="edge-cases">Edge cases</h3>

<p>These mappings have a flaw which is only apparent when you use them at the boundaries of a document. For example, if the cursor is placed on the last line of a file and you try to move it up by one line, instead it moves up by two lines. Remember that these mappings are blind, they just replay a series of keystrokes, without any understanding of context.</p>

<h2 id="text-bubble-with-unimpairedvim">Text bubble with unimpaired.vim</h2>

<p>A better solution is available if you install Tim Pope's <a href="http://www.vim.org/scripts/script.php?script_id=1590">unimpaired</a> plugin. This provides the <em>exchange</em> commands, which are mapped to <code>[e</code> and <code>]e</code> respectively:</p>

<pre><code>[e  -  Exchange the current line with [count] lines above it.
]e  -  Exchange the current line with [count] lines below it.
</code></pre>

<p>These commands can be prepended with a count, and they both also work in Visual mode. Whatsmore, they handle edgecases more gracefully, by raising an error message: <strong>Invalid address</strong>.</p>

<p>If you have the unimpaired plugin installed, then you can use the "square bracket e" commands to bubble text up and down. But if you are used to the TextMate key commands, you could always recreate those mappings and hook into the commands from unimpaired. This excerpt of Vimscript should do it:</p>

<pre class="brush: vimscript">
&quot; Bubble single lines
nmap &lt;C-Up&gt; [e
nmap &lt;C-Down&gt; ]e
&quot; Bubble multiple lines
vmap &lt;C-Up&gt; [egv
vmap &lt;C-Down&gt; ]egv
</pre>

<h2 id="visually-select-the-last-edited-text">Visually select the last edited text</h2>

<p>You may already know that <a href="http://vimdoc.sourceforge.net/htmldoc/visual.html#gv"><code>gv</code></a> can be used to start visual mode with the same selection as last time visual mode was used. If you have cut and pasted a visual selection, then this doesn't work the way that you would expect. Fortunately, you can visually select the text from the last edit by jumping to the first and last characters with the motions <code>\</code>[<code> and </code>`]`.</p>

<p>I keep the following mapping in my <code>.vimrc</code>:</p>

<pre class="brush: vimscript">
" Visually select the text that was last edited/pasted
nmap gV `[v`]
</pre>

<p>So with <code>gv</code> I can reselect the last visual selection, and with <code>gV</code> I can visually select the text that was most recently edited or pasted.</p>

<h3 id="further-reading">Further reading</h3>

<ul>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/visual.html#gv"><code>:help gv</code></a> - reselect last visual selection</li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/motion.html#'["><code>:help \`[</code></a> - go to first character of latest edit</li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/motion.html#']"><code>:help \`]</code></a> - go to last character of latest edit</li>
  <li><a href="http://www.vim.org/scripts/script.php?script_id=1590">unimpaired.vim</a> - a plugin by Tim Pope (<a href="http://github.com/tpope/vim-unimpaired">source on github</a>)</li>
</ul>


        </div>
        </dd>
        <dd>
        <a href="#comments">Comments</a>
        <div id="comments" class="content">
          <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'vimcasts'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </div>
        </dd>
      </dl>

      <div>
        <p>
        Like this video? Spread the word!
        TODO: add social sharing buttons here.
        </p>
      </div>


      <div>
  <hr/>
  <h3>Related content</h3>
  <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">

    
    

    
      <li>
        <h4><a href="/episodes/using-external-filter-commands-to-reformat-html/">Using external filter commands to reformat HTML</a></h4>
        <p>We can use pandoc as a <a href="http://vimdoc.sourceforge.net/htmldoc/change.html#filter">filter</a> to clean up <abbr title="what you see is what you get">WYSIWYG</abbr>-generated HTML. Pandoc is a commandline program, but we can call it from inside Vim either using the <a href="http://vimdoc.sourceforge.net/htmldoc/various.html#:!">bang Ex command</a>, or by configuring <a title="formatprg" href="http://vimdoc.sourceforge.net/htmldoc/options.html#">the <code>formatprg</code> option</a> to make the <code>gq</code> operator invoke pandoc.</p>


      </li>
    
      <li>
        <h4><a href="/blog/2014/02/vimcasts-redesign-a-work-in-progress/">Vimcasts redesign: a work in progress</a></h4>
        <p>In the not-too-distant future, you can expect to see a revised design for Vimcasts.org. The most significant enhancements will be the addition of tags, site search, and a responsive design for smaller screens. Hannah Adcock, from <a href="http://contentedstrategy.com">contentedstrategy.com</a>, has been helping me out by analysing user feedback, as well as data from Google Analytics.</p>


      </li>
    
      <li>
        <h4><a href="/publications">Publications</a></h4>
        <p>Make yourself a faster and more efficient developer with the help of <a href='/publications'>these publications</a>.</p>
      </li>
    
      <li>
        <h4><a href="/training">Vim Training</a></h4>
        <p>Boost your productivity with a <a href='/training'>Vim training class</a>. Join a public class, or <a href='/training/private'>book a private session</a> for your team.</p>
      </li>
    
      <li>
        <h4><a href="/categories">Find by category</a></h4>
        <p>Vimcasts contains 65 free screencasts and 45 articles. <a href='/categories'>Browse all content by category</a>.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/tidying-whitespace/">Tidying whitespace</a></h4>
        <p>This episode demonstrates a few techniques for tidying up whitespace.  First, it looks at how to convert between tabs and spaces. Then it shows how to strip trailing whitespace, and finally, how to remove blank lines from a file.</p>


      </li>
    

  </ul>
</div>


      <div class="row footer">

  <hr/>

  <div class="small-6 columns">
    <ul class="inline-list">
      <li><a href="/about">About</a></li>
      <li><a href="/subscribe">Subscribe</a></li>
      <li><a href="/tipjar">Leave a tip</a></li>
    </ul>
  </div>

  <div class="small-6 columns">
    <p class="text-right">
    Vimcasts.org established MMX
    </p>
  </div>

</div>


    </div>
  </div>




      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>

