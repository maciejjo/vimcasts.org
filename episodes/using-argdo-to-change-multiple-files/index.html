<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Using :argdo to change multiple files</title>

    <link href="/stylesheets/normalize.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>

  <body>
    <div id="logo">
      <h1>
        
          <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
        
      </h1>
    </div>
    <p>The <code>:argdo</code> command allows us to execute an Ex command across all buffers in the arglist.  To demonstrate, we'll use the example of running the <code>:substitute</code> command across multiple files, then we'll see how to revert or save the changes.  We'll also compare the <code>:argdo</code> and <code>:bufdo</code> commands, and consider when it's appropriate to use each one.</p>

<p></p>

<p>The <code>argdo</code> command works like this:</p>

<pre><code>:argdo {cmd}
</code></pre>

<p>Where <code>{cmd}</code> could be any Ex command, such as <code>:substitute</code>, <code>:global</code>, or <code>:normal</code> for example. This is just like running:</p>

<pre><code>:first
:{cmd}
:next
:{cmd}
etc...
</code></pre>

<p>The <code>argdo</code> command works best when the <a title="hidden" href="http://vimdoc.sourceforge.net/htmldoc/options.html#"><code>'hidden'</code></a> setting is enabled. For more information, see Vimcast <a href="/e/6">episode 6 - Working with buffers</a>.</p>

<h3 id="using-argdo-with-substitute">Using <code>argdo</code> with <code>substitute</code></h3>

<p>The video demonstrates how to use <code>argdo</code> with the <code>substitute</code> comamnd. We start off simple:</p>

<pre><code>:argdo %s/\a/*/g
</code></pre>

<p>There's a problem with this command: if any of the buffers in the argument list do not contain a match for the pattern specified by the substitute command (in this case <code>\a</code>), then the substitue command will raise an error: <code>E486 pattern not found</code>. We can suppress this error by modifying the substitute command with the <code>e</code> flag (see <a href="http://vimdoc.sourceforge.net/htmldoc/change.html#:s_flags"><code>:help :s_flags</code></a>):</p>

<pre><code>:argdo %s/\a/*/ge
</code></pre>

<p>That cuts down some of the noise, but the substitute command still reports details of about the effect it has on each file in the argument list. We can suppress that output by prefixing the whole thing with <a href="http://vimdoc.sourceforge.net/htmldoc/various.html#:silent"><code>silent</code></a>:</p>

<pre><code>:silent argdo %s/\a/*/ge
</code></pre>

<p>Alternatively, we could use <code>:silent!</code>, which would suppress all output <em>including error messages</em>. That way, we could leave out the <code>e</code> flag:</p>

<pre><code>:silent! argdo %s/\a/*/g
</code></pre>

<h3 id="pasting-the-last-ex-command-into-the-command-line">Pasting the last Ex command into the command line</h3>

<p>On the command line, you can paste the contents of a register by pressing <a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#c_CTRL-R"><code>&lt;C-r&gt;{register}</code></a>. In this context, the <a href="http://vimdoc.sourceforge.net/htmldoc/change.html#quote:"><code>quote:</code></a> register comes in handy: it contains the last executed Ex command. For example, if we start out by running a simple substitute command:</p>

<pre><code>:%s/\a/*/g
</code></pre>

<p>To prefix this with argdo, simply type <code>:argdo</code>, then a space, then <code>&lt;C-r&gt;:</code> which will produce:</p>

<pre><code>:argdo %s/\a/*/g
</code></pre>

<p>After executing this command, the <code>:</code> register will contain <code>argdo %s/\a/*/g</code>. We could prefix this with <code>silent</code> by typing <code>:silent</code>, space, then <code>&lt;C-r&gt;:</code> to produce:</p>

<pre><code>:silent argdo %s/\a/*/g
</code></pre>

<p>You get the idea?</p>

<h3 id="argdo-vs-bufdo">:argdo Vs :bufdo</h3>

<p>Just as we can use <code>:argdo</code> to execute a command on each of the files in the arglist, we can use <code>:bufdo</code> to execute a command on each of the files in the buffer list. In some circumstances, the buffer list and arglist may refer to the same set of files. In this case, it would make no difference whether you used <code>:bufdo</code> or <code>:argdo</code>.</p>

<p>It's easy to add files to the buffer list (perhaps unintentionally), so if you use <code>:bufdo</code> there's always a risk that it might end up touching a file that you didn't mean to change. Whereas the arglist only changes when you tell it to. For that reason, I prefer to use <code>:argdo</code> instead of <code>:bufdo</code>.</p>

<h3 id="further-reading">Further reading</h3>

<ul>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/editing.html#:argdo"><code>:help :argdo</code></a></li>
  <li><a title="hidden" href="http://vimdoc.sourceforge.net/htmldoc/options.html#"><code>:help 'hidden'</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/change.html#:s_flags"><code>:help :s_flags</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/various.html#:silent"><code>:help :silent</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/editing.html#:edit!"><code>:help :edit!</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/editing.html#:update"><code>:help :update</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/windows.html#:bufdo"><code>:help :bufdo</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#c_CTRL-R"><code>:help c_CTRL-R</code></a></li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/change.html#quote:"><code>:help quote:</code></a></li>
  <li><a href="/e/6">Working with buffers</a></li>
</ul>


  </body>

</html>
