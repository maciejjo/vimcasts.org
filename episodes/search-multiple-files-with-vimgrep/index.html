
<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Search multiple files with :vimgrep</title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="episodes episodes_search-multiple-files-with-vimgrep episodes_search-multiple-files-with-vimgrep_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      

<div class="row announcement-banner">
  <div class="small-12 column show-for-small-only">
    <div class="panel">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

      
    </div>
  </div>

  <div class="panel show-for-medium-up clearfix">
    <div class="small-8 column">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

    </div>

    <div class="small-4 column">
      
    </div>
  </div>

</div>



      <header>
        <h2>Search multiple files with :vimgrep</h2>
        <div class="episode_number">
          <small>#</small>44
        </div>
        <time pubdate="pubdate" datetime="2013-03- 1">
          Mar  1, 2013
        </time>
        <div class="video-duration">
          
          Run time: <time datetime="P7M,25S">
            7:25
          </time>
        </div>
        
          <div class="video-tags">
            Tagged with:
            <a href="/categories/arglist">arglist</a>, <a href="/categories/vimgrep">vimgrep</a>, <a href="/categories/search">search</a>
          </div>
        
      </header>

      <div data-swiftype-index="true">
        <p><code>vimgrep</code> is Vim&rsquo;s built-in command for searching across multiple files. It&rsquo;s not so fast as external tools like ack and git-grep, but it has its uses. <code>vimgrep</code> uses Vim&rsquo;s built-in regex engine, so you can reuse the patterns that work with Vim&rsquo;s standard search command. </p>


      </div>

      <video poster="http://vimcasts.org/images/posters/vimgrep.png"
        controls="controls" preload="none" class="placeholder"
        id="episode_44_placeholder">
        <source src="http://media.vimcasts.org/videos/44/vimgrep.ogv" type="video/ogg" />
        <source src="http://media.vimcasts.org/videos/44/vimgrep.m4v" type="video/x-m4v" />
      </video>

      <aside class="downloads">
        <ul class="inline-list">
          <li>Download: </li>

          <li class="ogg">
          <a href="http://media.vimcasts.org/videos/44/vimgrep.ogv">OGG</a>
          <span class="stats">13.2 MB</span>
          </li>

          <li class="quicktime">
          <a href="http://media.vimcasts.org/videos/44/vimgrep.m4v">Quicktime</a>
          <span class="stats">22.1 MB</span>
          </li>

      </ul>

        <p>
          View a <a href="/transcripts/44/en/">transcript of the video</a>.
        </p>
      </aside>

      <dl class="accordion" data-accordion>
        <dd>
        <a href="#shownotes">Shownotes</a>
        <div id="shownotes" class="content" data-swiftype-index="true">
          

<p>Have you ever wished that Vim would report your position as you navigate through search matches? For example, by saying: &lsquo;match 2 out of 5&rsquo;.</p>

<p>That&rsquo;s not a feature provided by Vim&rsquo;s search command, but it is a feature supplied by the <a href="http://vimdoc.sourceforge.net/htmldoc/quickfix.html#quickfix">quickfix list</a>. We can use the <a href="http://vimdoc.sourceforge.net/htmldoc/quickfix.html#:vimgrep"><code>:vimgrep</code></a> command to populate the quickfix list with search results from the current file:</p>
<pre class="highlight plaintext">:vimgrep /{pattern}/ %
</pre>

<p>The <a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#:_%"><code>%</code> character is a special symbol</a>, which represents the filepath of the active buffer.</p>

<p>The <code>{pattern}</code> field behaves more or less as you would expect. You can supply any pattern that would work with Vim&rsquo;s standard search command.</p>

<h3>Searching for the last pattern</h3>

<p>You can search for the last pattern in your search history by running:</p>
<pre class="highlight plaintext">:vimgrep /&lt;C-r&gt;// %
</pre>

<p>On the command line, <code>&lt;C-r&gt;/</code> (that is: <a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#c_CTRL-R"><code>CTRL-R</code></a> followed by <code>/</code>) will insert the last search pattern.</p>

<h3>Specifiying the set of files for <code>vimgrep</code> to search</h3>

<p>When running the <code>vimgrep</code> command, we have to specify at least one file for the command to search inside. We could provide:</p>

<ol>
<li>one or more filepaths (separated by whitespace)</li>
<li>a wildcard</li>
<li>a backtick expression</li>
<li>the <code>##</code> symbol, representing the arglist</li>
</ol>

<p>The first three from this list should look familiar if you&rsquo;ve watched <a href="/e/42">Vimcast #42 - Populating the arglist</a>.</p>

<p>The <a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#:_##">special ## symbol</a> is expanded to represent each of the files from the arglist. It&rsquo;s really handy in this context. Suppose that we wanted to search the same set of files for one pattern, then another pattern, and so on. It would be a drag to have to specify the same set of files again and again:</p>
<pre class="highlight plaintext">:vim /pattern1/ `find . -type f`
:vim /pattern2/ `find . -type f`
:vim /pattern3/ `find . -type f`
</pre>

<p>We can avoid this repetition by populating the arglist with the set of files we want to work with, then using the special symbol <code>##</code> (double hash) to reference the arglist:</p>
<pre class="highlight plaintext">:args `find . -type f`
:vim /pattern1/ ##
:vim /pattern2/ ##
:vim /pattern3/ ##
</pre>

<p>Not having to think about which files you&rsquo;re dealing with frees you up to focus on the more interesting part of the <code>vimgrep</code> command: the pattern.</p>

<p>For more ideas on how to specify the set of files for <code>vimgrep</code> to look inside, check out these articles on <a href="http://vimcasts.org/blog/2013/03/combining-vimgrep-with-ack--f/"><code>ack -f</code></a> and <a href="http://vimcasts.org/blog/2013/03/combining-vimgrep-with-git-ls-files/"><code>git ls-files</code></a>.</p>

<h3>Navitating the quickfix list</h3>

<p>The results from the <code>vimgrep</code> command are collected in the quickfix list. We can traverse them with the following commands:</p>

<table>
   <tr>
       <th>Ex command</th>
       <th>unimpaired map</th>
       <th>effect</th>
   </tr>
   <tr>
       <td><code>:cprev[ious]</code></td>
       <td><code>[q</code></td>
       <td>reverse through quickfix list</td>
   </tr>
   <tr>
       <td><code>:cnext</code></td>
       <td><code>]q</code></td>
       <td>advance through quickfix list</td>
   </tr>
   <tr>
       <td><code>:cfirst</code></td>
       <td><code>[Q</code></td>
       <td>go to start of quickfix list</td>
   </tr>
   <tr>
       <td><code>:clast</code></td>
       <td><code>]Q</code></td>
       <td>go to end of quickfix list</td>
   </tr>
</table>

<p>The square-bracket mappings are not built-in to Vim, but are added by Tim Pope&rsquo;s <a href="https://github.com/tpope/vim-unimpaired">unimpaired plugin</a> (which I recommend).</p>

<h3>Vimgrep: pros, cons, and alternatives</h3>

<p>I reach for <code>vimgrep</code> when I want to use Vim&rsquo;s built-in regex engine. I love being able to test my regular expression in one buffer using the search command, then use the same pattern without modification to search across the entire project. For me, that convenience is the killer feature of <code>vimgrep</code>.</p>

<p>On the downside, <code>vimgrep</code> isn&rsquo;t as quick as some of the alternatives out there. If you want to search a large codebase and get results fast, then you&rsquo;d be better off using an external tool like <a href="http://www.kernel.org/pub/software/scm/git/docs/git-grep.html"><code>git-grep</code></a>, <a href="http://betterthangrep.com/"><code>ack</code></a> or <a href="https://github.com/ggreer/the_silver_searcher">the silver searcher</a>. All of these external tools integrate with the quickfix list, and you can find Vim plugins for each of them:</p>

<ul>
<li><a href="https://github.com/tpope/vim-fugitive">fugitive</a> provides the <code>:Ggrep</code> command</li>
<li><a href="https://github.com/mileszs/ack.vim">Ack.vim</a> provides the <code>:Ack</code> command</li>
<li><a href="https://github.com/rking/ag.vim">ag.vim</a> provides the <code>:Ag</code> command</li>
</ul>

<p>The downside to using these external tools it that each uses a different regex syntax from Vim&rsquo;s.</p>

<h3>Further reading</h3>

<ul>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/quickfix.html#quickfix"><code>:help quickfix</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/quickfix.html#:vimgrep"><code>:help :vimgrep</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#:_%"><code>:help :_%</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#:_##"><code>:help :_##</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/change.html#:su"><code>:help :substitute</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/repeat.html#:g"><code>:help :global</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/cmdline.html#c_CTRL-R"><code>:help c_CTRL-R</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/change.html#quote/"><code>:help quote/</code></a></li>
<li><a href="http://pragprog.com/book/dnvim/practical-vim">Practical Vim</a> - chapter 12: Matching Patterns and Literals</li>
<li><a href="http://pragprog.com/book/dnvim/practical-vim">Practical Vim</a> - chapter 16: Compile code and navigate errors with the quickfix list</li>
<li><a href="http://pragprog.com/book/dnvim/practical-vim">Practical Vim</a> - chapter 17: Search project-wide with grep, vimgrep, and others</li>
<li><a href="https://github.com/tpope/vim-unimpaired">unimpaired.vim</a></li>
</ul>

        </div>
        </dd>
        <dd>
        <a href="#comments">Comments</a>
        <div id="comments" class="content">
          <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'vimcasts'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </div>
        </dd>
      </dl>

      <div>
        <p>
        Like this video? Spread the word!
        TODO: add social sharing buttons here.
        </p>
      </div>


      <div>
  <hr/>
  <h3>Related content</h3>
  <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">

    
    

    
      <li>
        <h4><a href="/categories">Find by category</a></h4>
        <p>Vimcasts contains 65 free screencasts and 45 articles. <a href='/categories'>Browse all content by category</a>.</p>
      </li>
    
      <li>
        <h4><a href="/training">Vim Training</a></h4>
        <p>Boost your productivity with a <a href='/training'>Vim training class</a>. Join a public class, or <a href='/training/private'>book a private session</a> for your team.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/using-argdo-to-change-multiple-files/">Using :argdo to change multiple files</a></h4>
        <p>The <code>:argdo</code> command allows us to execute an Ex command across all buffers in the arglist.  To demonstrate, we&rsquo;ll use the example of running the <code>:substitute</code> command across multiple files, then we&rsquo;ll see how to revert or save the changes.  We&rsquo;ll also compare the <code>:argdo</code> and <code>:bufdo</code> commands, and consider when it&rsquo;s appropriate to use each one.</p>


      </li>
    
      <li>
        <h4><a href="/blog/2013/03/combining-vimgrep-with-git-ls-files/">Combining :vimgrep with git ls-files</a></h4>
        <p>The <code>vimgrep</code> command uses Vim&rsquo;s native regular expressions to search the contents of multiple files. There are several ways that we can specify the list of files to look inside, including <code>*</code> and <code>**</code> wildcards. It would be handy if we could instruct <code>vimgrep</code> to look inside all of the files in the current project, excluding those listed in the <code>.gitignore</code> file. That&rsquo;s where the <a href="https://www.kernel.org/pub/software/scm/git/docs/git-ls-files.html"><code>git ls-files</code></a> command comes in.</p>


      </li>
    
      <li>
        <h4><a href="/blog/2013/03/combining-vimgrep-with-ack--f/">Combining :vimgrep with ack -f</a></h4>
        <p>I love the way that ack let&rsquo;s me specify the files to search inside. For starters, ack does the right thing by ignoring the contents of VCS directories, backup files, core dumps etc., which gives a good signal to noise ratio. On top of that, ack provides a convenient syntax for specifying filetypes to include or exclude from the set (see <code>ack --help-types</code>). I can target ruby files only with the <code>--ruby</code> option, or everything but ruby files with <code>--noruby</code>.</p>

<p>I also love using <code>:vimgrep</code>, because it lets me use Vim&rsquo;s native regular expressions. For me, the ideal project-wide search would combine Vim&rsquo;s regex with ack&rsquo;s method of specifying the set of files to search through. I recently learned about ack&rsquo;s <code>-f</code> flag, which makes this combination possible.</p>


      </li>
    
      <li>
        <h4><a href="/publications">Publications</a></h4>
        <p>Make yourself a faster and more efficient developer with the help of <a href='/publications'>these publications</a>.</p>
      </li>
    

  </ul>
</div>


      <div class="row footer">

  <hr/>

  <div class="small-6 columns">
    <ul class="inline-list">
      <li><a href="/about">About</a></li>
      <li><a href="/subscribe">Subscribe</a></li>
      <li><a href="/tipjar">Leave a tip</a></li>
    </ul>
  </div>

  <div class="small-6 columns">
    <p class="text-right">
    Vimcasts.org established MMX
    </p>
  </div>

</div>


    </div>
  </div>




      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>

