
<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>Fugitive.vim - working with the git index</title>

    
      <meta name="st:robots" content="follow, index">
    

    
      <link href="/feeds/ogg.rss" title="Vimcasts OGG Feed" rel="alternate" type="application/rss+xml" />
    
      <link href="/feeds/quicktime.rss" title="Vimcasts Quicktime Feed" rel="alternate" type="application/rss+xml" />
    

    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/autocomplete.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/syntax.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="episodes episodes_fugitive-vim-working-with-the-git-index episodes_fugitive-vim-working-with-the-git-index_index" data-swiftype-index='false'>

  <div class="off-canvas-wrap">
    <div class="inner-wrap">

      <div class="top-bar-underlay"></div>

      <div class="row">
        <nav class="top-bar show-for-large-up" data-topbar>
          <ul class="title-area">
            <li class="name">
              <h1><a href="/">Vimcasts</a></h1>
            </li>
            <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
          </ul>

          <section class="top-bar-section">

            
              <!-- Right Nav Section -->
              <ul class="right">
                <li class="has-form">
                <div class="row collapse">
                  <div class="large-12 columns">
                    <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


                  </div>
                </div>
                </li>
              </ul>
            

            <!-- Left Nav Section -->
            <ul class="left">
              <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>


            </ul>
          </section>
        </nav>
      </div>

      <nav class="tab-bar hide-for-large-up">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
        </section>

        <section class="middle tab-bar-section"></section>
      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Vimcasts</label></li>
          <li class="has-dropdown">
  <a href="/categories">Browse Vimcasts</a>
  <ul class="dropdown">
    <li><a href="/episodes">Latest episodes</a></li>
    <li><a href="/blog">Latest articles</a></li>
  </ul>
</li>
<li><a href="/training">Training</a></li>
<li><a href="/publications">Publications</a></li>



          
            <li>
              <form class="swiftype-search-form">
  <input type="search" class="swiftype-search-input" placeholder="Search the archives"/>
</form>


            </li>
          
        </ul>
      </aside>

      <section class="main-section">

        <div class="row identity-row">
          <div id="logo" class="small-4 columns">
            <h1>
              
                <a href="/" title="Go to Vimcasts.org homepage">VimCasts.org</a>
              
            </h1>
          </div>
          <div class="small-7 small-offset-1 columns">
            
            <h4 class="text-right">
              Level-up your Vim<br/>
              <small>with Drew Neil, author of <a href="http://pragprog.com/book/dnvim/practical-vim">Practical&nbsp;Vim</a></small>
            </h4>
            
          </div>
        </div>

          <div class="row">
    <div class="small-12 columns">

      

<div class="row announcement-banner">
  <div class="small-12 column show-for-small-only">
    <div class="panel">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

      
    </div>
  </div>

  <div class="panel show-for-medium-up clearfix">
    <div class="small-8 column">
      <p>
            No Core Vim Classes are currently scheduled. <a href="#">Sign up to the mailing list</a> to hear of upcoming classes.
</p>

    </div>

    <div class="small-4 column">
      
    </div>
  </div>

</div>



      <header>
        <h2>Fugitive.vim - working with the git index</h2>
        <div class="episode_number">
          <small>#</small>32
        </div>
        <time pubdate="pubdate" datetime="2011-04-29">
          Apr 29, 2011
        </time>
        <div class="video-duration">
          
          Run time: <time datetime="P11M,41S">
            11:41
          </time>
        </div>
        
          <div class="video-tags">
            Tagged with:
            <a href="/categories/plugins">plugins</a>, <a href="/categories/fugitive">fugitive</a>, <a href="/categories/git">git</a>, <a href="/categories/workflow">workflow</a>, <a href="/categories/vimdiff">vimdiff</a>
          </div>
        
      </header>

      <div data-swiftype-index="true">
        <p>The fugitive plugin provides an interactive status window, where you can easily stage and review your changes for the next commit. The <code>:Gdiff</code> command visualizes the changes made to a file, by comparing the working copy with the index. In this episode, we&rsquo;ll learn how to stage hunks of changes to the index without using the <code>git add --patch</code> command.</p>

<p><em>This is the second of a five part series on fugitive.vim. In the next episode, we&rsquo;ll learn how to resolve a git merge conflict by performing a 3-way vimdiff.</em></p>


      </div>

      <video poster="http://vimcasts.org/images/posters/fugitive_2.png"
        controls="controls" preload="none" class="placeholder"
        id="episode_32_placeholder">
        <source src="http://media.vimcasts.org/videos/32/fugitive_2.ogv" type="video/ogg" />
        <source src="http://media.vimcasts.org/videos/32/fugitive_2.m4v" type="video/x-m4v" />
      </video>

      <aside class="downloads">
        <ul class="inline-list">
          <li>Download: </li>

          <li class="ogg">
          <a href="http://media.vimcasts.org/videos/32/fugitive_2.ogv">OGG</a>
          <span class="stats">18.3 MB</span>
          </li>

          <li class="quicktime">
          <a href="http://media.vimcasts.org/videos/32/fugitive_2.m4v">Quicktime</a>
          <span class="stats">24.6 MB</span>
          </li>

      </ul>

        <p>
          View a <a href="/transcripts/32/en/">transcript of the video</a>.
        </p>
      </aside>

      <dl class="accordion" data-accordion>
        <dd>
        <a href="#shownotes">Shownotes</a>
        <div id="shownotes" class="content" data-swiftype-index="true">
          

<h3>The Gstatus window</h3>

<p>The <code>:Gstatus</code> command opens a status window. The contents closely resemble the output from running <code>git status</code> in the shell, but fugitive makes the window interactive. You can jump directly between files with <code>ctrl-n</code> and <code>ctrl-p</code>.</p>

<table>
  <tr>
    <th>command</th>
    <th>affect</th>
  </tr>
  <tr>
    <td><code>-</code></td>
    <td>add/reset file (works in visual mode too)</td>
  </tr>
  <tr>
  <td><code>&lt;Enter&gt;</code></td>
    <td>open current file in the window below</td>
  </tr>
  <tr>
    <td><code>p</code></td>
    <td>run `git add &ndash;patch` for current file</td>
  </tr>
  <tr>
    <td><code>C</code></td>
    <td>invoke <code>:Gcommit</code></td>
  </tr>
</table>

<h3>Working with the git index</h3>

<p>The git index is where you put changes that you want to be included in the next commit. If you are used to working with the command line git client, you might think of the index as an abstract concept. But with fugitive, you can actually read the index version of a file into a buffer by running:</p>
<pre class="highlight plaintext">:Gedit :path/to/file
</pre>

<p>If you run <code>:Gedit</code> with no arguments from a working tree file, it will open the index version of that file. 
You can always open the index version of the current file by running any one of the following:</p>
<pre class="highlight plaintext">:Gedit
:Gedit :0
:Gedit :%
</pre>

<p>It helps to understand the lifecycle of the index file between two commits. To begin with, the contents of the index and working copy files will be exactly the same as the most recent commit. As you make changes to your working copy, its contents begin to diverge from those of the index file. Staging a file updates the contents of the index file to match those of the working copy. When you commit your work, it is the contents of the index file that are saved with that commit object.</p>

<p><img alt="Index Lifecycle" src="/images/blog/index-lifecycle.png" /></p>

<h3>Comparing working copy with index version using <code>:Gdiff</code></h3>

<p>When you run:</p>
<pre class="highlight plaintext">:Gdiff
</pre>

<p>on a work tree file without any arguments, fugitive performs a vimdiff against the index version of the file. This opens a vertical split window, with the index file on the left and the working copy on the right. The files always appear in that order, so you can commit that to memory.</p>

<h3>Wholesale reconciliation</h3>

<p>The <code>:Gread</code> and <code>:Gwrite</code> commands can either add a file to the index or reset the file, depending on where they are called from. The following table and diagrams summarize the possibilities:</p>

<table>
  <tr>
    <th>command</th>
    <th>active window</th>
    <th>affect</th>
  </tr>
  <tr>
    <td><code>:Gwrite</code></td>
    <td>working copy</td>
    <td>stage file</td>
  </tr>
  <tr>
    <td><code>:Gread</code></td>
    <td>working copy</td>
    <td>checkout file</td>
  </tr>
  <tr>
    <td><code>:Gwrite</code></td>
    <td>index</td>
    <td>checkout file</td>
  </tr>
  <tr>
    <td><code>:Gread</code></td>
    <td>index</td>
    <td>stage file</td>
  </tr>
</table>

<p><img alt="Gread Gwrite Matrix" src="/images/blog/Gread-Gwrite-matrix.png" /></p>

<h3>Piecemeal reconciliation</h3>

<p>Vim&rsquo;s built in <code>:diffget</code> and <code>:diffput</code> commands work a bit like <code>:Gread</code> and <code>:Gwrite</code>, except that they are more granular. Whereas <code>:Gread</code> will completely overwrite the current buffer with the contents of the other buffer, <code>:diffget</code> will only pull in a patch at a time.</p>

<table>
<tr>
  <th>command</th>
  <th>active window</th>
  <th>affect</th>
</tr>
<tr>
  <td><code>:diffput</code></td>
  <td>working copy</td>
  <td>stage hunk</td>
</tr>
<tr>
  <td><code>:diffget</code></td>
  <td>working copy</td>
  <td>checkout hunk</td>
</tr>
<tr>
  <td><code>:diffput</code></td>
  <td>index</td>
  <td>checkout hunk</td>
</tr>
<tr>
  <td><code>:diffget</code></td>
  <td>index</td>
  <td>stage hunk</td>
</tr>
</table>

<p><img alt="Diffget Diffput Matrix" src="/images/blog/diffget-diffput-matrix.png" /></p>

<h3>Further reading</h3>

<ul>
<li><a href="http://book.git-scm.com/1_the_git_index.html">the git index</a> (<a href="http://book.git-scm.com/7_the_git_index.html">more</a>)</li>
<li><a href="http://ethanschoonover.com/solarized">solarized colorscheme</a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/diff.html#:diffget"><code>:help :diffget</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/diff.html#:diffput"><code>:help :diffput</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/diff.html#do"><code>:help do</code></a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/diff.html#dp"><code>:help dp</code></a></li>
</ul>

        </div>
        </dd>
        <dd>
        <a href="#comments">Comments</a>
        <div id="comments" class="content">
          <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'vimcasts'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        </div>
        </dd>
      </dl>

      <div>
        <p>
        Like this video? Spread the word!
        TODO: add social sharing buttons here.
        </p>
      </div>


      <div>
  <hr/>
  <h3>Related content</h3>
  <ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-3">

    
    

    
      <li>
        <h4><a href="/categories">Find by category</a></h4>
        <p>Vimcasts contains 65 free screencasts and 45 articles. <a href='/categories'>Browse all content by category</a>.</p>
      </li>
    
      <li>
        <h4><a href="/training">Vim Training</a></h4>
        <p>Boost your productivity with a <a href='/training'>Vim training class</a>. Join a public class, or <a href='/training/private'>book a private session</a> for your team.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/fugitive-vim-resolving-merge-conflicts-with-vimdiff/">Fugitive.vim - resolving merge conflicts with vimdiff</a></h4>
        <p>When git branches are merged, there is always the chance of a conflict arising if a file was modified in both the target and merge branches. You can resolve merge conflicts using a combination of fugitive&rsquo;s <code>:Gdiff</code> command, and Vim&rsquo;s built in <code>diffget</code> and <code>diffput</code>. In this episode, we&rsquo;ll find out how.</p>

<p><em>This is the third in a five part series on fugitive.vim.</em></p>


      </li>
    
      <li>
        <h4><a href="/episodes/fugitive-vim---a-complement-to-command-line-git/">Fugitive.vim - a complement to command line git</a></h4>
        <p><a href="https://github.com/tpope/vim-fugitive">The fugitive plugin</a>, by Tim Pope, is a git wrapper for Vim. It  complements the command line interface to git, but doesn&rsquo;t aim to replace it. In this episode, we&rsquo;ll see how some of fugitive&rsquo;s commands can streamline your workflow.</p>

<p><em>This is the first of a five part series on fugitive.</em></p>


      </li>
    
      <li>
        <h4><a href="/publications">Publications</a></h4>
        <p>Make yourself a faster and more efficient developer with the help of <a href='/publications'>these publications</a>.</p>
      </li>
    
      <li>
        <h4><a href="/episodes/fugitive-vim-browsing-the-git-object-database/">Fugitive.vim - browsing the git object database</a></h4>
        <p>With the fugitive plugin, you&rsquo;re not limited to just working with files in your working tree. The <code>:Gedit</code> command allows you to open files in other branches, and to browse any <a href="http://book.git-scm.com/1_the_git_object_model.html">git object</a>, including tags, commits and trees. Plus, if your repository is hosted on github, you can easily bring up the webpage for any git object using the <code>:Gbrowse</code> command.</p>

<p><em>This is the penultimate of a five part series on fugitive.vim.</em></p>


      </li>
    

  </ul>
</div>


      <div class="row footer">

  <hr/>

  <div class="small-6 columns">
    <ul class="inline-list">
      <li><a href="/about">About</a></li>
      <li><a href="/subscribe">Subscribe</a></li>
      <li><a href="/tipjar">Leave a tip</a></li>
    </ul>
  </div>

  <div class="small-6 columns">
    <p class="text-right">
    Vimcasts.org established MMX
    </p>
  </div>

</div>


    </div>
  </div>




      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

  <script src="/javascripts/all.js" type="text/javascript"></script>

  </body>
</html>

